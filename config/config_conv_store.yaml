# Conversation storage configuration
# This file configures where and how conversation history is stored

# Default storage endpoint to use
default_storage: qdrant_local

# Storage endpoints configuration
storage_endpoints:
  
  # Local Qdrant storage (default)
  qdrant_local:
    enabled: true
    type: qdrant
    # Local file-based storage path
    database_path: "../data/conversations_db"
    # Collection name for conversations
    collection_name: nlweb_conversations
    # Vector size for embeddings
    vector_size: 1536
    
  
  # Azure AI Search storage
  azure_search:
    enabled: false
    type: azure_ai_search
    # Azure Search endpoint (from environment variable)
    api_key_env: AZURE_VECTOR_SEARCH_API_KEY
    endpoint_env: AZURE_VECTOR_SEARCH_ENDPOINT
    # Index name for conversations
    collection_name: nlweb_conversations
    # Vector size for embeddings
    vector_size: 1536
    

  # Elasticsearch storage
  elasticsearch:
    enabled: false
    type: elasticsearch
    # Elasticsearch endpoint (localhost or remote URL with Elastic Cloud/Serverless)
    url_env: ELASTICSEARCH_URL
    # Authentication credentials
    api_key_env: ELASTICSEARCH_API_KEY
    # Collection name (index name) for conversations
    collection_name: nlweb_conversations
    vector_type:
      type: dense_vector
      index_options:
        type: int8_hnsw # byte quantization for efficient storage
    rrf:
      rank_constant: 60
    knn:
      num_candidates: 100

# Storage behavior configuration
storage_behavior:
  # Whether to store conversations for anonymous users
  store_anonymous: true
  
  # Maximum conversation history per thread
  max_conversations_per_thread: 100
  
  # Maximum threads per user
  max_threads_per_user: 1000
  
  # Conversation retention policy (in days)
  retention_days: 365
  
  # Whether to compute embeddings for conversations
  compute_embeddings: true
  
  # Batch size for bulk operations
  batch_size: 100
  
  # Enable conversation search
  enable_search: true
  
  # Migration settings
  migration:
    # Auto-migrate from localStorage when user logs in
    auto_migrate_on_login: true
    # Maximum conversations to migrate per user
    max_migrate_conversations: 500